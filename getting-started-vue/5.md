## Lesson 5. Basic functionality: View, complete, and delete tasks from the To Do tab

Out-of-the-box, the `<ListView>` component detects a tap gesture for every item and emits an event for it. The event carries information about the index of the tapped array item and the array item itself. To let the user choose the outcome of a tap gesture and expand the functionality of your app, you can tie a dialog to the event.

[`dialogs`](https://docs.nativescript.org/api-reference/modules/_ui_dialogs_) is a globablly available module that provides several configurable dialog types for apps: alert, action, prompt, login, confirmation. This tutorial explores the use of [`action()`](https://nativescript-vue.org/en/docs/elements/dialogs/action/) to let the user choose if they want to mark a task as completed or delete it from the list of active tasks.

### Step 1. Show completed tasks

Use a `<ListView>` to list completed tasks on the screen.

<hr data-action="start" />

#### Action

* **a.** In the second `<TabViewItem>` block, remove the `<Label>` element. Drag and drop a `<ListView>` element, clean up its contents (remove the `<FlexboxLayout>` but keep the `<Label>`), and set a height for it.

* **b.** In the newly added `<ListView>` component show items from an array of completed tasks (`dones`). The code is similar to the one used for showing active tasks. Change the name of the related method from `onItemTap` to `onDoneTap`.

```HTML
<ListView class="list-group" for="done in dones" @itemTap="onDoneTap" style="height:75%">
  <v-template>
    <Label :text="todo.name" class="list-group-item-heading" textWrap="true" />
  </v-template>
</ListView>
```

* **c.** List the new array in the `data` block in the `<script>` section.

```JavaScript
data() {
  return {
    dones: [],
    todos: [{ name: "Feed dogs" }, { name: "Ride bike" }, { name: "Go grocery shopping" }],
    textFieldValue: "",
  };
},
```

<hr data-action="end" />

### Step 2. Handle active tasks

Use an `action()` dialog to prompt users to select what they want to do with an active task: complete it, delete it, or dismiss the dialog.

<hr data-action="start" />

* **a.** In the `<script>` section, modify the `onItemTap` method:
  * Rename the method to `onTodoItemTap` and switch it to consume `item` instead of `args`.
  * Method catches the index of the tapped item. 
  * Method shows an `action()` dialog.
  * Method logs user selection in the console for debugging.
  * Based on user selection, the method moves elements from the `todos` array to the `dones` array, deletes elements from the `todos` array, or dismisses the dialog. Use `splice()` to avoid leaving holes in the array and `unshift()` to make sure that recently completed tasks are shown on top.
  * When the method moves a task to the `dones` array, use the `activeTabIndex` to switch the tab to the completed tab.

```JavaScript
onTodoItemTap(item) {
  const index = this.todos.indexOf(item);
  action('What do you want to do with this task?', 'Cancel', ['Mark completed', 'Delete forever'])
    .then(result => {
      console.log(result); // Logs the selected option for debugging.
      switch (result) {
        case 'Mark completed':
          this.dones.unshift(item); // Places the tapped active task at the top of the completed tasks.
          this.todos.splice(index, 1); // Removes the tapped active task.
          this.activeTabIndex = 1; // Switches the tab to the completed tab.
          break;
        case 'Delete forever':
          this.todos.splice(index, 1); // Removes the tapped active task.
          break;
        case 'Cancel' || undefined: // Dismisses the dialog.
          break;
      }
  }) 
},
```

<hr data-action="end" />

At the end of this lesson, your `<template>` and `<script>` blocks should resemble this sample:

```HTML
<template>
  <Page class="page">
    <!-- Having an ActionBar lets you change the status bar color on iOS, even if the ActionBar isnâ€™t being used. -->
    <!-- See https://docs.nativescript.org/ui/change-status-bar-style-ios for details -->
    <ActionBar title=" " flat="true" />

    <TabView height="100%" :selectedIndex="activeTabIndex" @selectedIndexChange="onTabChange">
      <TabViewItem title="To Do">
        <!-- Positions an input field, a button, and the list of tasks in a vertical stack. -->
        <StackLayout orientation="vertical" width="100%" height="100%">

          <GridLayout columns="2*,*" rows="*" width="100%" height="25%">
            <TextField col="0" row="0" v-model="textFieldValue" hint="Type new task..." editable="true" @returnPress="onButtonTap" />
            <!-- Configures the text field and ensures that pressing Return on the keyboard produces the same result as tapping the button. -->
            <Button col="1" row="0" text="+" @tap="onButtonTap" />
          </GridLayout>

          <ListView class="list-group" for="todo in todos" @itemTap="onTodoItemTap" style="height:75%">
            <v-template>
              <Label :text="todo.name" class="list-group-item-heading" />
            </v-template>
          </ListView>
        </StackLayout>
      </TabViewItem>
      <TabViewItem title="Completed">
        <ListView class="list-group" for="done in dones" @itemTap="onItemTap" style="height:75%">
          <v-template>
            <Label :text="todo.name" class="list-group-item-heading" textWrap="true" />
          </v-template>
        </ListView>
      </TabViewItem>
    </TabView>
  </Page>
</template>

<script>
  export default {
    methods: {
      onTodoItemTap(item) {
        const index = this.todos.indexOf(item);
        action('What do you want to do with this task?', 'Cancel', ['Mark completed', 'Delete forever'])
          .then(result => {
            console.log(result); // Logs the selected option for debugging.
            switch (result) {
              case 'Mark completed':
                this.dones.unshift(item); // Places the tapped active task at the top of the completed tasks.
                this.todos.splice(index, 1); // Removes the tapped active task.
                this.activeTabIndex = 1; // Switches the tab to the completed tab.
                break;
              case 'Delete forever':
                this.todos.splice(index, 1); // Removes the tapped active task.
                break;
              case 'Cancel' || undefined: // Dismisses the dialog.
                break;
            }
        }) 
      },

      onButtonTap() {
          if (this.textFieldValue === "") return; // Prevents users from entering an empty string.
          console.log("New task added: " + this.textFieldValue + "."); // Logs the newly added task in the console for bugging.
          this.todosnshift({ name: is.textFieldValue }); // Adds tasks in the ToDo array. Newly added tasks are immediately shown on the screen.
          this.textFieldValue = ""; // Clears the text field so that users can start adding new tasks immediately.
      },

      onTabChange(index) {
            this.activeTabIndex = index;
      }
    },

    data() {
      return {
        dones: [],
        // Prefill a few just for testing purposes.
        todos: [{ name: "Feed dogs" }, { name: "Ride bike" }, { name: "Go grocery shopping" }],
        textFieldValue: "",
        activeTabIndex: 0,
      };
    },
}
</script>
```
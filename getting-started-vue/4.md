## Lesson 4. Basic functionality: Add tasks

The layout components let you arrange the various user interface widgets of your app. Whenever you need to place more than one UI widget on your app screen, you are likely to use one of the available layouts. The `<GridLayout>` is a basic but versatile options, letting you position elements in a table-like layout. 

The `<GridLayout>` lets you choose the exact positions of your elements in the grid.

### Step 1. Create the layout

Replace the default layout with a combination of two `<GridLayout>` elements and configure the grids to accommodate the UI elements of your app.

<hr data-action="start" />

#### Action

* **а.** Delete the `<Label>` component from the first `<TabViewItem>` block.
* **b.** Drag and drop a `<GridLayout>` component within the `<TabViewItem>` block for the first tab.<br/>The default code creates a colorful table that shows how to position elements and merge grid cells.
* **c.** Delete all `<Label>` components from the `<GridLayout>` block.
* **d.** Drag and drop a `<Label>` component within the `<GridLayout>` block for the first tab.<br/>You can use this to create and control the header for the tab.
* **e.** Drag and drop a `<GridLayout>` component within the `<GridLayout>` block for the first tab.
* **f.** Delete all `<Label>` components from the `<GridLayout>` block.
* **g.** Set the top-level `<GridLayout>` to consist of three rows.
* **h.** Configure the nested `<GridLayout>`.
    * Set the grid to consist of two columns and one row.
    * Remove any additional settings for the grid.

<hr data-action="end" />

### Step 2. Add and arrange the UI elements

Arrange a `<TextField>` and a `<Button>` in the grid. They form the input functionality of the app.

Use a `<ListView>` to show newly added tasks below the input field.

Arrange all UI elements in the grid by setting the row they inhabit.

<hr data-action="start" />

#### Action

* **a.** Drag and drop a `<TextField>` and a `<Button>` within the nested `<GridLayout>` block.<br/>The Playground adds JavaScript code to your code for the first time. Note the `data()` and `methods` blocks added in the `<script>` block below. In next implementation steps, you will need to add code to these sections to create some of the app functionality.
* **b.** Drag and drop a `<ListView>` below the nested grid.<br/>The default code creates a list of countries and country flag icons.
* **c.** Configure the positioning of the elements within the top-level grid.
    * Set the `<Label>` to inhabit the first row.
    * Set the nested `<GridLayout>` to inhabit the second row.
    * Set the `<ListView`> to inhabit the third row.
* **d.** Configure the positioning of the elements within the nested grid (the input area).
    * Set the `<TextField>` to inhabit the first column and the first row.
    * Set the `<Button>` to inhabit the second column and the first row.
* **e.** In the `<TextField>` definition, use the `editable` property to enable text input from the field.
* **f.** Clean up sample code from the `<ListView>`&mdash;remove the `<FlexboxLayout>` element but keep the `<Label>`. Set a height for the `<ListView>`. Set `textWrap="true"` for the `<Label>`.

<hr data-action="end" />

At the end of this stage, your `<template>` block should resemble this sample:

```HTML
<template>
    <Page class="page">
        <!-- Having an ActionBar lets you change the status bar color on iOS, even if the ActionBar isn’t being used. -->
        <!-- See https://docs.nativescript.org/ui/change-status-bar-style-ios for details -->
        <ActionBar title=" " flat="true" />

        <TabView height="100%">
            <TabViewItem title="To Do">
                <!-- Positions an input field, a button, and the list of tasks in a vertical stack. -->
                <GridLayout rows="auto, auto, *">
                    <Label row="0" text="My Tasks" />
                    <GridLayout row="1" rows="auto" columns="auto, *">
                        <TextField col="0" row="0" v-model="textFieldValue" hint="Type new task..." editable="true" /> <!-- Configures the text field and ensures that pressing Return on the keyboard produces the same result as tapping the button. -->
                        <Button col="1" row="0" text="+" @tap="onButtonTap" />
                    </GridLayout>

                    <ListView row="2" class="list-group" for="country in countries" @itemTap="onItemTap" style="height:75%">
                        <v-template>
                            <Label :text="todo.name" class="list-group-item-heading" textWrap="true" />
                        </v-template>
                    </ListView>
                </GridLayout>
            </TabViewItem>
            <TabViewItem title="Completed">
                <Label text="This tab will list completed tasks for tracking." textWrap="true" />
            </TabViewItem>
        </TabView>
    </Page>
</template>
```

### Step 3. Create the logic

Scroll down to the `<script>` block and examine the `methods` and `data` sections. Use basic JavaScript methods to create simple logic for adding tasks.

<hr data-action="start" />

* **a.** Remove the `countries` array and create a new `todos` array for newly added tasks. Prefill the array with a few options. Update the `<ListView>` to use the newly created array.
* **b.** Modify the `OnButtonTap` method to check if the input is an empty string.
* **c.** Modify the `OnButtonTap` method to log newly added tasks in the console.
* **d.** Modify the `OnButtonTap` method to add newly created tasks in the array of tasks. Use `unshift` to place new items at the top.
* **e.** Modify the `OnButtonTap` method to clear the text field after input.

```JavaScript
onButtonTap() {
    if (this.textFieldValue === "") return; // Prevents users from entering an empty string.
    console.log("New task added: " + this.textFieldValue + "."); // Logs the newly added task in the console for debugging.
    this.todos.unshift({ name: this.textFieldValue }); // Adds tasks in the ToDo array. Newly added tasks are immediately shown on the screen.
    this.textFieldValue = ""; // Clears the text field so that users can start adding new tasks immediately.
},
```

* **e.** Return to the `<template>` block and modify the `<ListView>`. Insert another `<GridLayout>` within the `v-template` block in the list view to arrange the tasks and small tappable icons before them. 

```HTML
<ListView row="2" class="list-group" for="todo in todos">
    <v-template>
        <GridLayout columns="auto, *">
            
        </GridLayout>
    </v-template>
</ListView>
```

* **f.** Use `<Label>` elements to represent the task name and the icon. Add the `textWrap="true"` property to ensure that longer tasks display properly. In the next lessons, you can tie code to the labels. In Lesson 7, you can use a CSS class to style the small tappable button in front of the task name. 

```HTML
<ListView row="2" class="list-group" for="todo in todos">
    <v-template>
        <GridLayout columns="auto, *">
            <Label col="0" text=" " />
            <Label col="1" :text="todo.name" textWrap="true" />
        </GridLayout>
    </v-template>
</ListView>
```

* **g.** Modify the `<TextField>` so that pressing `Return` on the keyboard acts as pressing the in-app button. Use the `@returnPress` property.

```HTML
<TextField col="0" row="0" v-model="textFieldValue" hint="Type new task..." editable="true" @returnPress="onButtonTap" />
```

<hr data-action="end" />

### Step 4. Always start the app on the To Do tab

Use the `selectedIndex` property of the `<TabView>` to ensure that the app always launches on the tab for active tasks.

<hr data-action="start" />

#### Action

* **a.** In the `data` block, create an `activeTabIndex` variable to represent the currently selected tab. Note that the tab counter starts from `0` and set the initial value of the `activeTabIndex` to `0`. This ensures that when the app loads after a restart, it will always start on the tab for the active tasks.

```JavaScript
activeTabIndex: 0,
```

* **b.** In the `<TabVIew>` definition, set the `selectedIndex` property and bind it to the `activeTabIndex` variable. Add the `selectedIndexChanged` event listener to catch when the tab is being changed. 

```HTML
<TabView height="100%" :selectedIndex="activeTabIndex" @selectedIndexChanged="onTabChange">
```

* **c.** In the `methods` block, handle the change in value for `activeTabIndex`. Note that the `selectedIndexChange` event emits and event object containing a `value` property with the index of the tapped tab.

```JavaScript
onTabChange(tab) {
      this.activeTabIndex = tab.value;
}
```

<hr data-action="end" />

At the end of this lesson, your `<template>` and `<script>` blocks should resemble this sample:

```HTML
<template>
    <Page class="page">
        <!-- Having an ActionBar lets you change the status bar color on iOS, even if the ActionBar isn’t being used. -->
        <!-- See https://docs.nativescript.org/ui/change-status-bar-style-ios for details -->
        <ActionBar title=" " flat="true" />

        <TabView height="100%" :selectedIndex="activeTabIndex" @selectedIndexChange="onTabChange">
            <TabViewItem title="To Do">
                <!-- Positions an input field, a button, and the list of tasks in a vertical stack. -->
                <GridLayout rows="auto, auto, *">
                    <Label row="0" text="My Tasks" />
                    <GridLayout row="1"  rows="auto" columns="auto, *">
                        <!-- Configures the text field and ensures that pressing Return on the keyboard produces the same result as tapping the button. -->
                        <TextField col="0" row="0" v-model="textFieldValue" hint="Type new task..." editable="true" @returnPress="onButtonTap" /> 
                        <Button col="1" row="0" text="+" @tap="onButtonTap" />
                    </GridLayout>

                    <ListView row="2" class="list-group" for="todo in todos">
                        <v-template>
                            <GridLayout columns="auto, *">
                                <Label col="0" text=" " />
                                <Label col="1" :text="todo.name" textWrap="true" />
                            </GridLayout>
                        </v-template>
                    </ListView>
                </GridLayout>
            </TabViewItem>
            
            <TabViewItem title="Completed">
                <Label text="This tab will list completed tasks for tracking." textWrap="true" />
            </TabViewItem>
        </TabView>
    </Page>
</template>

<script>
    export default {
    methods: {
        onItemTap: function(args) {
            console.log('Item with index: ' + args.index + ' tapped');
        },

        onButtonTap() {
            if (this.textFieldValue === "") return; // Prevents users from entering an empty string.
            console.log("New task added: " + this.textFieldValue + "."); // Logs the newly added task in the console for debugging.
            this.todos.unshift({ name: this.textFieldValue }); // Adds tasks in the ToDo array. Newly added tasks are immediately shown on the screen.
            this.textFieldValue = ""; // Clears the text field so that users can start adding new tasks immediately.
        },

        onTabChange(tab) {
            this.activeTabIndex = tab.value;
        }
    },

    data() {
        return {
            // Prefill a few just for testing purposes.
            todos: [{ name: "Feed dogs" }, { name: "Ride bike" }, { name: "Go grocery shopping" }],

            textFieldValue: "",
            activeTabIndex: 0,
        };
    },
}
</script>
```